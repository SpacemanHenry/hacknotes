# Primary Token Theft

## Useful resources:
  *  [MS docs about access tokens](https://learn.microsoft.com/en-us/windows/win32/secauthz/access-tokens)
  *  [ired.team has a page covering this](https://www.ired.team/offensive-security/privilege-escalation/t1134-access-token-manipulation)
  *  [MITRE ATT&CK reference](https://attack.mitre.org/techniques/T1134/)

## How it works  
  *  Obtain handle to process running as SYSTEM
  *  Duplicate the access token from this process
  *  Spawn new process using this stolen token

## Compilation  
  *  Easy to cross-compile for windows from linux using `go`
  *  Change the `PID` value within the `const` block before deployment
 
```
GOOS=windows GOARCH=amd64 go build -o PrimaryTokenTheft.exe main.go
GOOS=windows GOARCH=386 go build -o PrimaryTokenTheft.exe main.go
```
